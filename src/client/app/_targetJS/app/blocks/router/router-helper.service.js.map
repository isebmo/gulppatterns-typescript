{"version":3,"sources":["app/blocks/router/router-helper.service.ts"],"names":[],"mappings":"AAAA,IAAO,MAAM,CAyDZ;AAzDD,WAAO,MAAM;IAAC,IAAA,MAAM,CAyDnB;IAzDa,WAAA,MAAM,EAAC,CAAC;QACpB,YAAY,CAAC;QAMb;YAEE,sBAAoB,SAAc,EAAU,UAAe,EAAU,MAAW,EAAU,MAAW;gBAAjF,cAAS,GAAT,SAAS,CAAK;gBAAU,eAAU,GAAV,UAAU,CAAK;gBAAU,WAAM,GAAN,MAAM,CAAK;gBAAU,WAAM,GAAN,MAAM,CAAK;gBAKrG,gBAAW,GAAG,EAAE,MAAM,EAAE,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC;gBAEhC,6BAAwB,GAAY,KAAK,CAAC;gBANhD,IAAI,CAAC,mBAAmB,EAAE,CAAC;gBAC3B,IAAI,CAAC,kBAAkB,EAAE,CAAC;YAC5B,CAAC;YAMO,0CAAmB,GAA3B;gBAAA,iBAsBK;gBArBG,qDAAqD;gBACrD,sBAAsB;gBACtB,yCAAyC;gBACzC,qDAAqD;gBACrD,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,mBAAmB,EACnC,UAAC,KAAU,EAAE,OAAY,EAAE,QAAa,EAAE,SAAc,EAAE,UAAe,EAAE,KAAU;oBACjF,EAAE,CAAC,CAAC,KAAI,CAAC,wBAAwB,CAAC,CAAC,CAAC;wBAChC,MAAM,CAAC;oBACX,CAAC;oBACD,KAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;oBAC1B,KAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC;oBACrC,IAAI,WAAW,GAAG,CAAC,OAAO;wBACtB,CAAC,OAAO,CAAC,KAAK,IAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,iBAAiB,CAAC,CAAC;wBAC7D,gBAAgB,CAAC;oBACrB,IAAI,GAAG,GAAG,mBAAmB,GAAG,WAAW,GAAG,IAAI;wBAC9C,CAAC,KAAK,CAAC,IAAI,IAAI,EAAE,CAAC,GAAG,SAAS,GAAG,CAAC,KAAK,CAAC,UAAU,IAAI,EAAE,CAAC;wBACzD,IAAI,GAAG,CAAC,KAAK,CAAC,MAAM,IAAI,EAAE,CAAC,CAAC;oBAChC,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;oBACpC,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBAC7B,CAAC,CACA,CAAC;YACV,CAAC;YAEO,yCAAkB,GAA1B;gBAAA,iBASC;gBARG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,qBAAqB,EACrC,UAAC,KAAU,EAAE,OAAY,EAAE,QAAa,EAAE,SAAc,EAAE,UAAe,EAAE,KAAU;oBACjF,KAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;oBAC3B,KAAI,CAAC,wBAAwB,GAAG,KAAK,CAAC;oBACtC,4DAA4D;oBAC5D,IAAI,KAAK,GAAG,CAAC,OAAO,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC;oBAClC,KAAI,CAAC,UAAU,CAAC,KAAK,GAAG,KAAK,CAAC,CAAC,uBAAuB;gBAC1D,CAAC,CAAC,CAAC;YACX,CAAC;YA3CE,oBAAO,GAAkB,CAAC,WAAW,EAAE,YAAY,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;YA4ChF,mBAAC;QAAD,CA7CF,AA6CG,IAAA;QA7CU,mBAAY,eA6CtB,CAAA;QAED,OAAO;aACF,MAAM,CAAC,eAAe,CAAC;aACvB,OAAO,CAAC,cAAc,EAAE,YAAY,CAAC,CAAC;IAC/C,CAAC,EAzDa,MAAM,GAAN,aAAM,KAAN,aAAM,QAyDnB;AAAD,CAAC,EAzDM,MAAM,KAAN,MAAM,QAyDZ","file":"app/blocks/router/router-helper.service.js","sourcesContent":["module blocks.router {\n  'use strict';\n\n  export interface IRouterHelper {\n    stateCounts: { errors: number; changes: number };\n  }\n\n  export class RouterHelper implements IRouterHelper {\n    static $inject: Array<string> = ['$location', '$rootScope', '$state', 'logger'];\n    constructor(private $location: any, private $rootScope: any, private $state: any, private logger: any) {\n      this.handleRoutingErrors();\n      this.handleStateChanges();\n    }\n\n    stateCounts = { errors: 0, changes: 0 };\n\n    private handlingStateChangeError: boolean = false;\n\n    private handleRoutingErrors() {\n            //TODO: must inject $state so we can kick off routing\n            // Route cancellation:\n            // On routing error, go to the dashboard.\n            // Provide an exit clause if it tries to do it twice.\n            this.$rootScope.$on('$stateChangeError',\n                (event: any, toState: any, toParams: any, fromState: any, fromParams: any, error: any) => {\n                    if (this.handlingStateChangeError) {\n                        return;\n                    }\n                    this.stateCounts.errors++;\n                    this.handlingStateChangeError = true;\n                    var destination = (toState &&\n                        (toState.title || toState.name || toState.loadedTemplateUrl)) ||\n                        'unknown target';\n                    var msg = 'Error routing to ' + destination + '. ' +\n                        (error.data || '') + '. <br/>' + (error.statusText || '') +\n                        ': ' + (error.status || '');\n                    this.logger.warning(msg, [toState]);\n                    this.$location.path('/');\n                }\n                );\n        }\n\n        private handleStateChanges() {\n            this.$rootScope.$on('$stateChangeSuccess',\n                (event: any, toState: any, toParams: any, fromState: any, fromParams: any, error: any) => {\n                    this.stateCounts.changes++;\n                    this.handlingStateChangeError = false;\n                    //var title = config.docTitle + ' ' + (toState.title || '');\n                    var title = (toState.title || '');\n                    this.$rootScope.title = title; // data bind to <title>\n                });\n        }\n    }\n\n    angular\n        .module('blocks.router')\n        .service('RouterHelper', RouterHelper);\n}\n"],"sourceRoot":"/source/"}